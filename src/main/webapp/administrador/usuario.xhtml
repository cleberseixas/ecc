<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:sec="http://www.springframework.org/security/facelets/tags"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>ECC-SLG</title>
	<link rel="shortcut icon" href="../resources/imagens/SLG.ico" />
	<h:outputStylesheet library="css" name="modelo.css" />
	<h:outputStylesheet library="css" name="menu.css" />
	<h:outputStylesheet library="css" name="AdminLTE.css" />
</h:head>

<h:body style="background-color:#EBF3FE">
	<h:form id="edicao">
		<div id="menubar">
			<li class="icone"><h:graphicImage library="imagens" name="logo_ECC.png" width="400" height="72" /></li>
			<ul>
				<li><a href="../publico/estatistica.xhtml">
					<h:graphicImage library="imagens/menu"
									style="width:35px; height:35px;" name="estatisticas.png" />Indicadores
				</a></li>
				<li><a><h:graphicImage library="imagens/menu"
									   style="width:35px; height:35px;" name="cadastros.png" />Cadastros</a>
					<ul>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="circulos.png" /><a
								href="circulo.xhtml">Circulos</a>
						</li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="palestras.png" /><a
								href="palestra.xhtml">Palestras</a>
						</li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="equipes.png" /><a
								href="equipe.xhtml">Equipes</a>
						</li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="usuarios.png" />
							<a style="color: #808080; background: #a0c0de; opacity: 1;
							filter: alpha(opacity = 100); border-bottom: 3px solid #b1b1b1;">Usuários</a>
						</li>
					</ul>
				</li>
				<li><a><h:graphicImage library="imagens/menu"
									   style="width:35px; height:35px;" name="montagem.png" />Montagem</a>
					<ul>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="ecc.png" /><a href="../dirigente/ecc.xhtml">ECC
						</a></li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="fichas.png" /><a href="../dirigente/montagemFicha.xhtml">Fichas
						</a></li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="montagemEquipes.png" /><a href="../dirigente/montagemEquipe.xhtml">Equipes
						</a></li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="montagemCasais.png" /><a
								href="../dirigente/montagemEncontrista.xhtml">Encontristas</a>
						</li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="montagemPalestrantes.png" /><a
								href="../dirigente/montagemPalestrante.xhtml">Palestrantes</a></li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="montagemCirculos.png" /><a
								href="../dirigente/montagemCirculo.xhtml">Círculos</a></li>
						<li><h:graphicImage library="imagens/menu"
											style="width:30px; height:30px;
								margin-left:10px; margin-top:8px; margin-right:9px;"
											name="montagemCirculosEstudos.png" /><a
								href="../dirigente/montagemCirculoEstudo.xhtml">Círculos de Estudo</a></li>

					</ul>
				</li>
			</ul>
		</div>
		<br />
		<br />
		<div id="status" style="...">
			<div id="ico">
				<h1>
					<h:graphicImage library="imagens/menu" name="usuarios.png"
									width="25px" height="25px" />
					<h5>
						<b>Usuários</b>
					</h5>
					<p:commandButton type="button" value="Sair" icon="ui-icon-extlink"
									 style="float: right; margin-right:5px; margin-top: -5px;"
									 onclick="document.location='#{request.contextPath}/j_spring_security_logout'" />
				</h1>
			</div>
			<div id="img-usuario-logado">
				<h5>Usuário logado: #{contextoBean.usuarioLogado.nome}</h5>
				<h1>
					<h:graphicImage library="imagens/menu" name="usuarioLogado.png"
									width="25px" height="25px" />
				</h1>
			</div>
		</div>
		<br />

		<p:growl id="growl" showDetail="false" life="2000" />
		<h:inputHidden value="#{usuarioBean.usuario.id}" />
		<h:inputHidden value="#{usuarioBean.usuario.ativo}" />
		<h:inputHidden value="#{usuarioBean.destinoSalvar}" />
		<h:inputHidden value="#{usuarioBean.senhaCriptografada}" />
		<p:panel header="Cadastro de Usuários"
			style="width:620px; background:#F1F2F5;">
			<h:panelGrid columns="2">
				<h:outputLabel value="Nome:" for="nome" />
				<p:inputText id="nome" label="Nome"
					value="#{usuarioBean.usuario.nome}" size="50"
					maxlength="50" required="true"
					requiredMessage="O campo Nome é obrigatório" style="width:270px;">
					<f:validateLength minimum="5" maximum="50" />
					<p:focus for="nome" />
				</p:inputText>
				<h:outputLabel value="E-Mail:" for="email" />
				<p:inputText id="email" label="E-Mail"
							 value="#{usuarioBean.usuario.email}" size="50"
							 maxlength="50" required="true"
							 requiredMessage="O campo E-Mail é obrigatório" style="width:270px;">
					<f:validateLength minimum="5" maximum="50" />
				</p:inputText>
				<h:outputLabel value="Perfil:" for="perfil" />
				<h:panelGroup>
					<p:selectOneMenu id="perfil"
						value="#{usuarioBean.usuario.perfil}" required="true"
						requiredMessage="O campo Perfil é obrigatório" style="width:130px;">
						<f:selectItem itemLabel="Selecione" noSelectionOption="true" />
						<f:selectItem itemValue="Administrador" itemLabel="Administrador" />
						<f:selectItem itemValue="Dirigente" itemLabel="Dirigente" />
						<f:selectItem itemValue="Secretária" itemLabel="Secretária" />
					</p:selectOneMenu>
					<p:selectBooleanCheckbox value="#{usuarioBean.usuario.dirigente}" itemLabel="Dirigente?" style="margin-left:5px;" />
				</h:panelGroup>
				<h:outputLabel value="Login:" for="login" />
				<p:inputText id="login" label="Login"
					value="#{usuarioBean.usuario.login}" size="60"
					maxlength="60" style="width:146px;" required="true"
					requiredMessage="O campo Login é obrigatório">
					<f:validateLength minimum="3" maximum="60" />
				</p:inputText>
				<h:outputLabel value="Senha:" for="senha" rendered="#{usuarioBean.usuario.id eq null}"/>
				<p:password id="senha" label="senha" rendered="#{usuarioBean.usuario.id eq null}"
							 value="#{usuarioBean.usuario.senha}" size="60"
							 maxlength="60" style="width:146px;" required="true"
							 requiredMessage="O campo Senha é é obrigatório">
					<f:validateLength minimum="3" maximum="20" />
				</p:password>
				<h:outputLabel value="" />
				<p:commandButton value="Salvar" action="#{usuarioBean.salvar}"
					icon="ui-icon-check" update=":edicao :listagem">
				</p:commandButton>
			</h:panelGrid>
		</p:panel>
	</h:form>
	<br />

	<h:form id="listagem">
		<p:panel style="width:893px; background-color:#d9d9d9">
			<h:panelGrid columns="5" styleClass="semBordaInterna">
				<h:outputLabel value="Usuários do ECC" styleClass="negrito" />
				<p:inputText id="txtPesquisa"  
					value="#{usuarioBean.pesquisaUsuario}" style="width:150px; margin-left:550px;"
					placeholder="Pesquisar Usuários"/>
				<p:commandButton icon="ui-icon-search" style="margin-top:1px;" action="#{usuarioBean.pesquisar()}" update="tabelaUsuarios"/>
			</h:panelGrid>
		</p:panel>	
	
		<p:dataTable value="#{usuarioBean.lista}" var="usuario" id="tabelaUsuarios"
			paginator="false" paginatorPosition="bottom" rows="20"
			rendered="#{!empty usuarioBean.lista}" style="width:900px;">

			<p:column headerText="Nome" width="180">
				<p:outputLabel value="#{usuario.nome}"/>
				<h:graphicImage library="imagens" name="dirigente.png" width="15" height="15" rendered="#{usuario.dirigente}"
				style="float: right;" title="Dirigente"/>
			</p:column>

			<p:column styleClass="Gildasio" headerText="Login" width="50">
				 #{usuario.login}
			</p:column>
			<p:column styleClass="Gildasio" headerText="E-Mail" width="130">
				#{usuario.email}
			</p:column>
			<p:column headerText="Perfil" width="80">
				<center>#{usuario.perfil}</center>
			</p:column>

			<p:column width="50">
				<f:facet name="header">Ativo</f:facet>
				<center>
					<h:commandLink action="#{usuarioBean.ativar}">
						<f:ajax execute="@this" render=":listagem" />
						<h:graphicImage library="imagens"
							name="#{usuario.ativo}.png" />
						<f:setPropertyActionListener
							target="#{usuarioBean.usuario}" value="#{usuario}" />
					</h:commandLink>
				</center>
			</p:column>

			<p:column headerText="Editar" width="50">
				<center>
					<h:commandLink>
						<f:ajax execute="@this" render=":edicao" />
						<h:graphicImage library="imagens" name="alterar.png" />
						<f:setPropertyActionListener
							target="#{usuarioBean.usuario}" value="#{usuario}" />
					</h:commandLink>
				</center>
			</p:column>

			<p:column headerText="Excluir" width="50">
				<center>
					<h:commandLink action="#{usuarioBean.excluir}"
						onclick="if (!confirm('Confirma a exclusão do usuário #{usuario.nome}?')) return false;">
						<f:ajax execute="@this" render=":listagem" />
						<h:graphicImage library="imagens" name="remover.png" />
						<f:setPropertyActionListener
							target="#{usuarioBean.usuario}" value="#{usuario}" />
					</h:commandLink>
				</center>
			</p:column>
		</p:dataTable>
	</h:form>
</h:body>
</html>
